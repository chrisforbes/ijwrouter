<html>
	<head>
		<title>New User</title>
		<link rel="Stylesheet" type="text/css" href="main.css" />
		<script type="text/javascript" src="jquery-1.2.3.min.js"></script>
		<script type="text/javascript" src="common.js"></script>
		<script type="text/javascript">
		<!--
			function optionselect(x, y)
			{
				$(x).removeAttr("disabled");
				$(y).attr("disabled", "disabled");
			}
			
			function submit_form()
			{
				if ( $("#change_name_option:checked").length > 0 )
				{
					$("#hidden_name").val( $("#name_field").val() );
					$("#name_form")[0].submit();
				}
				else
				{
					$("#hidden_merge").val( $("#merge_select").val() );
					$("#merge_form")[0].submit();
				}
			}
			
			$(function()
			{
				dialogs = $("#foo");
				
				show_dialog( $("#foo") );
				$.get("query/list", function(data)
				{
					var d = eval( "([" + data + "])" );
					for (var i = 0; i < d.length; i++)
						if ((d[i].flags & 2) > 0) 
							$("#merge_select").append("<option>" + d[i].uname + "</option>");
				});
			});
		//-->
		</script>
	</head>
	<body>
		<div id="foo" style="width: 600px; height: 320px;">
			<h1>Welcome to IJW Router</h1>
			<p>Boilerplate goes here.</p>
			<form>
				<p>
					<input type="radio" id="change_name_option" name="options" onclick="optionselect('#name_field', '#merge_select')" checked="checked"/>
					<label for="change_name_option">Yes, I am a new user. My name is:</label>
					<input type="text" id="name_field" name="name" />
				</p>
				<p>
					<input type="radio" id="merge_user_option" name="options" onclick="optionselect('#merge_select', '#name_field')"/>
					<label for="merge_user_option">I already have an account. It is:</label>
					<select id="merge_select" name="name" disabled="disabled"></select>
				</p>
				<p style="text-align: center">
					<input type="button" value="Submit" onclick="submit_form(); return false" />
				</p>
			</form>
			<form id="name_form" action="name" method="get" style="display: none">
				<p><input id="hidden_name" name="name" type="hidden" /></p>
			</form>
			<form id="merge_form" action="merge" method="get" style="display: none">
				<p><input id="hidden_merge" name="name" type="hidden" /></p>
			</form>
		</div>
	</body>
</html>